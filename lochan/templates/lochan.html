<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JFK Assassination Analysis</title>
    <link rel="stylesheet" href="/static/lochan.css">
</head>
<body>
    <div class="container">
        <header>
            <h1 id="main-title">The JFK Assassination</h1>
            <p id="subtitle">November 22, 1963 - Dallas, Texas</p>
            <div class="header-accent"></div>
        </header>

        <main>
            <div class="info-section">
                <h2>The Files</h2>
                <button id="loadInfoBtn" class="btn">Load Case Information</button>
                <div id="infoDisplay" class="info-display">
                    <!-- Information will be loaded here -->
                </div>
            </div>

            <div class="analysis-sections" id="analysis-sections" style="display: none;">
                <!-- Content will be loaded dynamically here -->
            </div>
        </main>

        <footer>
            <a href="/" class="btn">Back to Home Page</a>
            <p class="footer-text">Classified Information - Authorized Personnel Only</p>
        </footer>
    </div>

    <script>
        // Typewriter effect for main title
        function typewriter(element, text, speed = 100) {
            let i = 0;
            element.innerHTML = '';
            function type() {
                if (i < text.length) {
                    element.innerHTML += text.charAt(i);
                    i++;
                    setTimeout(type, speed);
                }
            }
            type();
        }

        // Initialize page animations
        document.addEventListener('DOMContentLoaded', function() {
            // Typewriter effect for title
            const title = document.getElementById('main-title');
            const originalText = title.textContent;
            typewriter(title, originalText, 150);

            // Animate sections on scroll
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);

            // Observe all analysis sections
            document.querySelectorAll('.analysis-section').forEach(section => {
                section.style.opacity = '0';
                section.style.transform = 'translateY(30px)';
                section.style.transition = 'all 0.6s ease';
                observer.observe(section);
            });

            // Add hover effects to buttons
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-3px) scale(1.05)';
                });
                btn.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
        });

        // Enhanced info loading with animation
        document.getElementById('loadInfoBtn').addEventListener('click', async function() {
            const btn = this;
            const infoDisplay = document.getElementById('infoDisplay');
            const analysisSections = document.getElementById('analysis-sections');
            
            // Show loading state
            btn.innerHTML = '<span class="loading"></span> Loading Files...';
            btn.disabled = true;
            
            try {
                const response = await fetch('/api/lochan/info');
                const data = await response.json();
                
                // Animate the display
                infoDisplay.style.opacity = '0';
                infoDisplay.style.transform = 'translateY(20px)';
                
                setTimeout(() => {
                    // Update the info display
                    infoDisplay.innerHTML = `
                        <div class="info-item">
                            <h3>Case Files Loaded</h3>
                            <p>All classified information has been successfully retrieved from the database.</p>
                        </div>
                    `;
                    
                    // Create the full analysis sections with database content
                    analysisSections.innerHTML = `
                        <section class="analysis-section" id="basic-info">
                            <h2>Basic Information</h2>
                            <div class="content">
                                ${data.basic_info}
                            </div>
                        </section>

                        <section class="analysis-section" id="stated-suspect">
                            <h2>Stated Suspect</h2>
                            <div class="content">
                                ${data.stated_suspect}
                            </div>
                        </section>

                        <section class="analysis-section" id="issues">
                            <h2>Issues & Controversies</h2>
                            <div class="content">
                                ${data.issues_controversies}
                            </div>
                        </section>

                        <section class="analysis-section" id="what-i-believe">
                            <h2>What I Believe</h2>
                            <div class="content">
                                ${data.what_i_believe}
                            </div>
                        </section>
                    `;
                    
                    // Show the analysis sections with animation
                    analysisSections.style.display = 'block';
                    analysisSections.style.opacity = '0';
                    analysisSections.style.transform = 'translateY(30px)';
                    
                    // Animate in the info display
                    infoDisplay.style.opacity = '1';
                    infoDisplay.style.transform = 'translateY(0)';
                    
                    // Animate in the analysis sections
                    setTimeout(() => {
                        analysisSections.style.opacity = '1';
                        analysisSections.style.transform = 'translateY(0)';
                        analysisSections.style.transition = 'all 0.6s ease';
                    }, 200);
                    
                }, 300);
                
            } catch (error) {
                console.error('Error loading information:', error);
                infoDisplay.innerHTML = '<p style="color: #ff6666;">Error loading information. Please try again.</p>';
            } finally {
                btn.innerHTML = 'Load Case Information';
                btn.disabled = false;
            }
        });

        // Smooth scrolling for internal links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // Add parallax effect to background
        window.addEventListener('scroll', function() {
            const scrolled = window.pageYOffset;
            const parallax = document.querySelector('body::before');
            if (parallax) {
                parallax.style.transform = `translateY(${scrolled * 0.5}px)`;
            }
        });
    </script>
</body>
</html>